- name: stop IIS service
  ansible.windows.win_service:
    name: W3SVC
    state: stopped

- name: sleep for 10 seconds after stopping IIS service
  pause:
    seconds: 10

- name: restore iis configuration file
  ansible.windows.win_copy:
    src: '{{ iis_config_file_path }}\{{ iis_config_bck_file_name }}'
    dest: '{{ iis_config_file_path }}\{{ iis_config_file_name }}'
    remote_src: yes

- name: delete backup file
  ansible.windows.win_file:
    path: '{{ iis_config_file_path }}\{{ iis_config_bck_file_name }}'
    state: absent

- name: start IIS service
  ansible.windows.win_service:
    name: W3SVC
    state: started
